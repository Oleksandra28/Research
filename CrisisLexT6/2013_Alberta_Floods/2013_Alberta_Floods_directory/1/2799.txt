Thousands flee flooding in western Canada